# Writer Worker Implementation

## Problem
Cover letters generated by the agent were poorly formatted/structured due to lack of context about expected format and style.

## Solution
Added a `writer_worker` that references existing documents linked to an entity as examples, then generates new documents matching that format/style.

## Files Changed

### New
- `internal/agent/workers/writer_worker.go` - Writer worker agent definition

### Modified
- `internal/agent/prompts/prompts.go`
  - Added `WriterWorkerInstructions` (calibrated per Anthropic's context engineering guide)
  - Updated `TriageInstructionsWithTools` to route writing requests to writer_worker
- `internal/agent/orchestrator.go`
  - Added writer worker to default agent creation (line 104)
  - Added writer worker to user-specific agent creation (lines 214, 223, 231, 238, 245)

## Architecture

```
User: "Write a cover letter for John Smith"
  ↓
Triage → writer_worker
  ↓
1. crm_lookup("individual", "John Smith") → ID
2. search_entity_documents("individual", ID) → find existing cover letters
3. read_document(doc_id) → read 1-3 examples
4. Generate new document matching format/structure
5. Return full text + offer to save
```

## Tools Available to Writer Worker
- `crm_lookup` - Find individual/organization
- `search_entity_documents` - Find documents linked to entity
- `read_document` - Read document content
- `crm_propose_create` - Propose saving document

## Prompt Calibration
Followed Anthropic's "Calibrating the System Prompt" guidance:
- Clear role statement
- Tool access description
- Response Framework (thinking steps, not rigid procedure)
- Flexible guidelines

## Branch
`feature/writer-worker`
